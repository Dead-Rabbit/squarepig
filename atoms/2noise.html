<!DOCTYPE html>
<html>
	<head>
		<title>squarepig demo - Bounce</title>

		<script type = "text/javascript" src = "src/squarepig.js"></script>
		<script type = "text/javascript" src = "src/perlin.js"></script>

		<script>

			function main() {
				pig.init('pig-canvas');

				// pig.run();
				var canvas = pig.canvas
				var ctx = pig.context

				var image = generateImage(canvas, ctx)

				ctx.putImageData(image, 0, 0);
			}

			function generateImage(canvas, ctx) {
				noise.seed(Math.random());

				var image = ctx.createImageData(canvas.width, canvas.height);
				var data = image.data;

				var _min = 0, _max = 0

				for (var x = 0; x < canvas.width; x++) {
				    for (var y = 0; y < canvas.height; y++) {
				        var value = noise.perlin2(x / 50, y / 50) / 2 + 0.5;

				        if (value > _max)
				        	_max = value
				        if (value < _min)
				        	_min = value

				        value *= 255;

				        var cell = (x + y * canvas.width) * 4;
				        data[cell] = data[cell + 1] = data[cell + 2] = value;
				        // data[cell] += Math.max(0, (25 - value) * 8);
				        data[cell + 3] = 255; // alpha.
				    }
				}
				console.log("Max is " + _max + " Min is " + _min)
				return image
			}

		</script>
	</head>
	<body onload = "main();">
		<canvas id = "pig-canvas" style = "width: 800px; height: 500px">
			<p>Hang on! Your browser doesn't support the &lt;canvas&gt; tag! You should get on that.</p>
		</canvas>
	</body>
</html>

