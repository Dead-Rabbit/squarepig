<!DOCTYPE html>
<html>
	<head>
		<title>squarepig demo - Bounce</title>

		<script>
			function Ball(x, y) {
				pig.Entity.apply(this) ;

				this.x = x ;
				this.y = y ;
				this.dx = 200;
				this.dy = 200;
				this.sprite = new pig.Sprite(x, y, "graphics/arrow/32/red.png", 32, 32);
				this.graphic = this.sprite;

				this.update = function(time) {

					this.x += this.dx * time ;
					this.y += this.dy * time ;

					var ifChange = false
					if(this.x + this.sprite.frameWidth > pig.canvas.width) {
						this.x = pig.canvas.width - this.sprite.frameWidth ;
						this.dx = -this.dx;
						ifChange = true
					}
					else if(this.x < 0) {
						this.x = 0 ;
						this.dx = -this.dx;
						ifChange = true
					}

					if(this.y + this.sprite.frameHeight > pig.canvas.height) {
						this.y = pig.canvas.height - this.sprite.frameHeight ;
						this.dy = -this.dy;
						ifChange = true
					}
					else if(this.y < 0) {
						this.y = 0 ;
						this.dy = -this.dy;
						ifChange = true
					}

					if (ifChange)
						this.changeAngle()

					this.graphic.place([this.x, this.y]) ;
				};

				this.changeAngle = function() {
					var angle = 0
					if (this.dx == 0)
					{
						angle = this.dy > 0 ? (0.5 * Math.PI) : (-0.5 * Math.PI)
					} else {
						var tanV = Math.atan(this.dy / this.dx)
						if (this.dx < 0) {
							angle = tanV + Math.PI 
						} else {
							angle = tanV
						}
					}
					this.sprite.angle = angle
				}
			}

			var ball;
			function main() {
				pig.init('pig-canvas') ;
				ball = new Ball(200, 200)
				ball.changeAngle()
				pig.world.add(ball);
				pig.run();
			}

		</script>
	</head>
	<body onload = "main();">
		<canvas id = "pig-canvas" style = "width: 512px; height: 512px">
			<p>Hang on! Your browser doesn't support the &lt;canvas&gt; tag! You should get on that.</p>
		</canvas>

		<p>Made with <a href = "https://github.com/aeonofdiscord/squarepig">squarepig</a>.</p>
		<script type = "text/javascript" src = "../squarepig.js"></script>
	</body>
</html>

